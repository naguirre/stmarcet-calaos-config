<?xml version="1.0" encoding="UTF-8" ?>
<calaos:rules xmlns:calaos="http://www.calaos.fr">
    <calaos:rule name="Xiamoi button" type="Chambre d&apos;Emma">
        <calaos:condition type="standard" trigger="true">
            <calaos:input id="io_9" oper="==" val="true" />
        </calaos:condition>
        <calaos:action type="standard">
            <calaos:output id="io_10" val="toggle" />
        </calaos:action>
    </calaos:rule>
    <calaos:rule name="Interrupteur" type="Cuisine">
        <calaos:condition type="standard" trigger="true">
            <calaos:input id="io_23" oper="==" val="true" />
        </calaos:condition>
        <calaos:action type="standard">
            <calaos:output id="io_22" val="toggle" />
        </calaos:action>
    </calaos:rule>
    <calaos:rule name="Interrupteur Hue ON" type="Chambre de Lison">
        <calaos:condition type="standard" trigger="true">
            <calaos:input id="io_27" oper="==" val="true" />
        </calaos:condition>
        <calaos:action type="standard">
            <calaos:output id="io_30" val="on" />
        </calaos:action>
    </calaos:rule>
    <calaos:rule name="Interrupteur Hue OFF" type="Chambre de Lison">
        <calaos:condition type="standard" trigger="true">
            <calaos:input id="io_26" oper="==" val="false" />
        </calaos:condition>
        <calaos:action type="standard">
            <calaos:output id="io_30" val="off" />
        </calaos:action>
        <calaos:action type="standard">
            <calaos:output id="intern_5" val="0" />
        </calaos:action>
    </calaos:rule>
    <calaos:rule name="Hue remote UP" type="Chambre de Lison">
        <calaos:condition type="standard" trigger="true">
            <calaos:input id="io_28" oper="==" val="true" />
        </calaos:condition>
        <calaos:action type="script">
            <calaos:script type="lua">
                <![CDATA[print("Lison light")

cnt = calaos:getInputValue("intern_5")

if cnt == 0 then
  calaos:setOutputValue("io_30", "set 1")
elseif cnt == 1 then
  calaos:setOutputValue("io_30", "set 25")
elseif cnt == 2 then
  calaos:setOutputValue("io_30", "set 50")
elseif cnt == 3 then
  calaos:setOutputValue("io_30", "set 100")
else
  calaos:setOutputValue("v", "false")
end

cnt = cnt + 1
if cnt > 3 then
    cnt = 0
end
calaos:setOutputValue("intern_5", cnt)
return true
]]>
</calaos:script>
        </calaos:action>
    </calaos:rule>
    <calaos:rule name="Gestion Plage Horarire" type="Général">
        <calaos:condition type="start" />
        <calaos:action type="script">
            <calaos:script type="lua">
                <![CDATA[		

while true do

    
    plage_horaire = calaos:getInputValue("input_7") 

    print(plage_horaire)

    if plage_horaire == true then
        print("Is true")
        t_jour = calaos:getInputValue("intern_0") 
        calaos:setOutputValue("intern_6", t_jour)
    else
        print("Is false")
        t_nuit = calaos:getInputValue("intern_1") 
        calaos:setOutputValue("intern_6", t_nuit)
    end 

    calaos:waitForIO("input_7")
end

return true
]]>
</calaos:script>
        </calaos:action>
    </calaos:rule>
    <calaos:rule name="Regle depart en vacance" type="Général">
        <calaos:action type="standard">
            <calaos:output id="intern_2" val="true" />
        </calaos:action>
    </calaos:rule>
    <calaos:rule name="Regle retour de vacances" type="Général">
        <calaos:action type="standard">
            <calaos:output id="intern_2" val="false" />
        </calaos:action>
    </calaos:rule>
    <calaos:rule name="Hors gel ON" type="Général">
        <calaos:condition type="standard" trigger="true">
            <calaos:input id="intern_2" oper="==" val="true" />
        </calaos:condition>
        <calaos:action type="standard">
            <calaos:output id="intern_6" val="6" />
        </calaos:action>
    </calaos:rule>
    <calaos:rule name="Hors Gel OFF" type="Général">
        <calaos:condition type="standard" trigger="true">
            <calaos:input id="intern_2" oper="==" val="false" />
        </calaos:condition>
        <calaos:action type="standard">
            <calaos:output id="intern_6" val="" val_var="intern_0" />
        </calaos:action>
    </calaos:rule>
    <calaos:rule name="Gestion Thermostat OFF" type="Bar">
        <calaos:condition type="standard" trigger="true">
            <calaos:input id="intern_2" oper="==" val="false" />
        </calaos:condition>
        <calaos:condition type="standard" trigger="true">
            <calaos:input id="io_3" oper="INF=" val="" val_var="intern_6" />
        </calaos:condition>
        <calaos:action type="standard">
            <calaos:output id="io_2" val="true" />
        </calaos:action>
        <calaos:action type="standard">
            <calaos:output id="intern_3" val="true" />
        </calaos:action>
    </calaos:rule>
    <calaos:rule name="Gestion Thermostat ON" type="Bar">
        <calaos:condition type="standard" trigger="true">
            <calaos:input id="io_3" oper="SUP" val="" val_var="intern_6" />
        </calaos:condition>
        <calaos:condition type="standard" trigger="true">
            <calaos:input id="intern_2" oper="==" val="false" />
        </calaos:condition>
        <calaos:action type="standard">
            <calaos:output id="io_2" val="false" />
        </calaos:action>
        <calaos:action type="standard">
            <calaos:output id="intern_3" val="false" />
        </calaos:action>
    </calaos:rule>
    <calaos:rule name="Gestion Consigne Jour" type="Général">
        <calaos:condition type="standard" trigger="true">
            <calaos:input id="intern_0" oper="==" val="changed" />
        </calaos:condition>
        <calaos:condition type="standard" trigger="true">
            <calaos:input id="input_7" oper="==" val="true" />
        </calaos:condition>
        <calaos:condition type="standard" trigger="true">
            <calaos:input id="intern_2" oper="==" val="false" />
        </calaos:condition>
        <calaos:action type="standard">
            <calaos:output id="intern_6" val="" val_var="intern_0" />
        </calaos:action>
    </calaos:rule>
    <calaos:rule name="Gestion Consigne Nuit" type="Général">
        <calaos:condition type="standard" trigger="true">
            <calaos:input id="intern_1" oper="==" val="changed" />
        </calaos:condition>
        <calaos:condition type="standard" trigger="true">
            <calaos:input id="input_7" oper="==" val="false" />
        </calaos:condition>
        <calaos:condition type="standard" trigger="true">
            <calaos:input id="intern_2" oper="==" val="false" />
        </calaos:condition>
        <calaos:action type="standard">
            <calaos:output id="intern_6" val="" val_var="intern_1" />
        </calaos:action>
    </calaos:rule>
    <calaos:rule name="Gestion Thermostat Jour" type="Cuisine">
        <calaos:condition type="standard" trigger="true">
            <calaos:input id="input_7" oper="==" val="true" />
        </calaos:condition>
        <calaos:action type="standard">
            <calaos:output id="intern_6" val="" val_var="intern_0" />
        </calaos:action>
    </calaos:rule>
    <calaos:rule name="Gestion Thermostat Nuit" type="Général">
        <calaos:condition type="standard" trigger="true">
            <calaos:input id="input_7" oper="==" val="false" />
        </calaos:condition>
        <calaos:action type="standard">
            <calaos:output id="intern_6" val="" val_var="intern_1" />
        </calaos:action>
    </calaos:rule>
</calaos:rules>
